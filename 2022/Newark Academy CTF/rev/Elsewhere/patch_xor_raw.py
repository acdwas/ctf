
from pwn import *

with open('./elsewhere', 'rb') as f:
    l = f.read()

l = list(l)

# asm write
# b801000000bf01000000ba400000004889e60f05

l[0x24ad] = 0x6c ^ 0xb8
l[0x24ae] = 0x61 ^ 0x01
l[0x24af] = 0x67 ^ 0x00
l[0x24b0] = 0x6e ^ 0x00
l[0x24b1] = 0x6f ^ 0x00
l[0x24b2] = 0x74 ^ 0xbf
l[0x24b3] = 0x20 ^ 0x01
l[0x24b4] = 0x66 ^ 0x00
l[0x24b5] = 0x6c ^ 0x00
l[0x24b6] = 0x61 ^ 0x00
l[0x24b7] = 0x67 ^ 0xba
l[0x24b8] = 0x6e ^ 0x40
l[0x24b9] = 0x6f ^ 0x00
l[0x24ba] = 0x74 ^ 0x00
l[0x24bb] = 0x20 ^ 0x00
l[0x24bc] = 0x66 ^ 0x48
l[0x24bd] = 0x6c ^ 0x89
l[0x24be] = 0x61 ^ 0xe6
l[0x24bf] = 0x67 ^ 0x0f
l[0x24c0] = 0x6e ^ 0x05

with open('./elsewhere_patch', 'wb') as f:
    for i in range(len(l)):
        f.write(p8(l[i]))


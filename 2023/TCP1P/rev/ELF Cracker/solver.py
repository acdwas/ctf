
l = list(bytes.fromhex('4579843C4B406E0630D5695B5E3690C0A6BE9421CCC394FEE9D8A5044F8D3B5BC7C9070724C3CC2D442A6A494F80D2134782AF8B8D5E20F2CFCC68F91361E73603F2193D322E354CB02E8BFEF3114A9AC4DA33CA705F24C4C9DF1D7D8CBCD18E5161B208355BD2508D3B812D10F5EF041E367D2D4AD89DF37D2FE20899E0ECE44C6B1A2314475F09EDBB3B6D82F0173BBB8A5CB2A086652A0BDCBA505CEB5A683DAD759802C128339FB5A79231DB3B8FDF0E6CE9AFA894ACD1603552D7EB15E5EA656F386A27F6F9AB2922389AC60D2DFECA5255D3542413F332CAC1F27915637C23030C379B187D78507A89AA5E31A9662D6CF469C2FB0ABF927222E3D3077C9563BC91838A192E27FAE33951462A3091A1761BE2AF4D00F14E9A04328E490EBD0AB396692F96DE7444D3174EE0159CD10D9FE745C66E574836FD15A53868AC6BB00C6DAB520FC841E7472627A6E5320F9CFA3940270CB4CEDF51CC32D7BCFB07D71DFEDB2AAE47052C7F8184E5768951829609E1DBBACB157A85FF8AEB291788EFA42DD3A3035809B4733627DB599AAA13EAC64F52D4BE3C4F62199E360FEBDA0FC9689AEF9956AF2171B765C4B5B18416904FC221ED7926A3CE3DDC6FCD437BE9F500213AC6F9EF6F85A39CD70293ACBD9B7A564131A949D26AFF21B81F5D0F35E61FDA77CEF3A482B318FAB29D96ED9A041C47CC2F19966BF4573B8D5D29377B3E4B6696ED692CB3EB6A7C88EA9C2808DEFA3B522F09748F0102838D48F443755C14ED7CF60DAD598F71923F39975B93F0AAA52B10F8D98EE47EFCAD924EAB5B5131DFBCA6A02C386AE396BB60C524DD868413810E4A0284BE1042D75C9C0FC5B2FAC14164D763F5EB54A661043779AFF987EB02A66679A50E94E1B02C9D7CE3FBDDB28D9E55BA9E6131368384857D6E04CB2FAD106B99E4846B11ABDEFE5C3DC8118011802C9F0BCD0DD5A4E4AB955E4EDC0A1565EF7E82B8A9326D4853ED88E5EE8EF2010E8AD4130633B95B392536908C4BFD0F1572C9576D20650FC5C941633C808AB33545B8971A95A00E9FA838F40BBDC7CBF1DCD358A0E9F51CB5A0F77D74DE1E395E500E592F8807DF4B2800777A80622DC3864B9406208577FC6C07802731134F89AA2CC8C6585E7C16CD9538ECEF28D655E67E5286381DFA627C1E7845411E360CCFA18863DFC490FEFE4679C5ABBD2F6FA103FBA8541935DB1DAD0B542BCBD10B462B7E3B978FDD48428016B61A174C14A9E501D336B9B1A124525F1CA446208A60A42A2AFC2740548F452B4A368108C9EC89092ABABD71282598B47E99A5F781977C1ECE35AF2207A014DDB5A636684B772F84C2FEE84DAE37353EA5477985EF62A500CB609B184E425BC15FE014141D9DE155B507E805B32CAFF6507C519FECB670779BDF0F47419661EDE0151D748410F31C24E890F9EA06525B65D340000B83EB54BCD6DE59B9704D42B2C6'))

a = []

for x in range(len(l)):
    for i in range(0x00, 0x100):
        v4 = 0
        v5 = i
        while v5:
            v4 ^= v5
            v5 //= 2

        if v4 == l[x]:
            a.append(i)
            break

a = a[::-1]

with open('flag', 'rb') as f:
    v = list(f.read())
    f.close()
    for i in range(len(a)):
        v[0x10a0+i] ^= a[i]


with open('flag_encode', 'wb') as f:
    f.write(bytes(v))

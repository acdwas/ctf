
import ctypes
from pwn import *

libsystem = ctypes.CDLL('libc.so.6')


def sub_1288(a1):
    libsystem.srand(a1)
    return libsystem.rand()


l = [1, 2, 3]
z = l[0]
w = ''
for j in range(20):
    a = sub_1288(z)
    w += str(a)[l[2]]
    z += l[1]

p = 'softbank:' + l + ":" + w + ":end"

r = remote('rev.chal.csaw.io', 5008)
r.recvuntil('>> ')
r.sendline(p)
f = r.recv()

print('KEY: ', p)
print("FLAG: ", f.split()[1].decode())


# FLAG:  flag{th4x_f0r_ur_cr3d1t_c4rd}


import ctypes
from itertools import permutations
from pwn import *

libsystem = ctypes.CDLL('libc.so.6')


def sub_1288(a1):
    libsystem.srand(a1)
    return libsystem.rand()


perm = permutations([1, 2, 3, 4, 5, 6, 7,  0], 3)

for i in list(perm):
    l = ''.join(str(x) for x in i)
    z = int(l[0])
    w = ''
    for j in range(20):
        a = sub_1288(z)
        # print(a, l[2])
        w += str(a)[int(l[2])]
        z += int(l[1])
    p = 'softbank:' + l + ":" + w + ":end"
    print(p)
    r = remote('rev.chal.csaw.io', 5008)
    r.recvuntil('>> ')
    r.sendline(p)
    f = r.recv()
    if b'flag' in f:
        print("FLAG: ", f.split()[1].decode())
        break
    r.close()

# softbank:123:22222222222222222222:end
# 25165359974429151334
# 1804289383
